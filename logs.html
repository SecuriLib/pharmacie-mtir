<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Pharmacie MTIR - Logs</title>

  <!-- Roboto + Material Icons -->
  <link
    href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap"
    rel="stylesheet"
  />
  <link
    href="https://fonts.googleapis.com/icon?family=Material+Icons"
    rel="stylesheet"
  />

  <style>
    /* RESET & VARIABLES */
    *{margin:0;padding:0;box-sizing:border-box}
    html,body{height:100%;font-family:"Roboto",sans-serif;background:#f5f5f5;color:#333;overflow:hidden}
    :root{
      --sidebar-width:240px;--sidebar-bg:#fff;--sidebar-border:#e0e0e0;
      --text-color:#495057;--heading-color:#6c757d;--active-bg:#f3f4f6;
      --active-border:#5c7cfa;--icon-color:#6c757d;--hover-bg:#f8f9fa;
      --card-bg:#fff;--card-shadow:rgba(0,0,0,0.05);--accent-color:#4b9eff;
      --log-bg:#fafafa;--log-border:#e0e0e0;
    }
    /* SIDEBAR */
    .sidebar{width:var(--sidebar-width);background:var(--sidebar-bg);
      border-right:1px solid var(--sidebar-border);display:flex;flex-direction:column;
      padding-top:24px;height:100vh;overflow-y:auto;position:fixed;top:0;left:0;}
    .sidebar .brand{display:flex;align-items:center;justify-content:center;margin-bottom:32px;padding:0 16px}
    .sidebar .brand .material-icons{font-size:32px;color:var(--active-border);margin-right:8px}
    .sidebar .brand .brand-text{font-size:20px;font-weight:700;color:var(--text-color)}
    .sidebar nav{flex-grow:1;list-style:none;padding-left:0}
    .sidebar nav .nav-group{margin-bottom:24px}
    .sidebar nav .group-title{font-size:12px;font-weight:500;color:var(--heading-color);
      text-transform:uppercase;padding:0 24px;margin-bottom:8px;letter-spacing:.5px}
    .sidebar nav ul{list-style:none;padding-left:0}
    .sidebar nav li{margin-bottom:4px}
    .sidebar nav a{display:flex;align-items:center;gap:12px;padding:10px 24px;
      text-decoration:none;color:var(--text-color);font-size:14px;
      border-right:4px solid transparent;transition:background-color .2s,border-color .2s}
    .sidebar nav a:hover{background:var(--hover-bg)}
    .sidebar nav a.active{background:var(--active-bg);border-right-color:var(--active-border)}
    .sidebar nav a.active .material-icons{color:var(--active-border)}
    .logout{margin-top:auto;padding:16px;text-align:center;border-top:1px solid var(--sidebar-border)}
    .logout a{display:flex;align-items:center;justify-content:center;gap:8px;
      text-decoration:none;color:var(--text-color);font-size:14px;padding:8px 16px;
      border-radius:4px;transition:background-color .2s}
    .logout a:hover{background:var(--hover-bg)}

    /* CONTENT */
    .content{margin-left:var(--sidebar-width);padding:32px;height:100vh;overflow-y:auto}
    .page-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:24px}
    .page-header h1{font-size:28px;color:#34495e}
    .page-header .welcome-msg{font-size:16px;color:#777}

    /* LOGS TABLE */
    .logs-table{width:100%;border-collapse:separate;border-spacing:0 8px;background:var(--log-bg)}
    .logs-table th{padding:12px 16px;text-align:left;background:var(--active-bg);font-weight:500;color:var(--heading-color);border-radius:8px 8px 0 0}
    .logs-table th:nth-child(1){border-radius:8px 0 0 0}
    .logs-table th:nth-child(2){border-radius:0 8px 0 0}
    .logs-table tbody tr{background:var(--card-bg);box-shadow:0 2px 4px var(--card-shadow);border-left:4px solid var(--accent-color);transition:background .2s}
    .logs-table tbody tr:hover{background:#fff}
    .logs-table td{padding:16px;vertical-align:top;border:none;color:#444;}
    .log-msg{white-space:pre-wrap;line-height:1.4;}
    .log-time{font-size:14px;color:#888;}
  </style>
</head>
<body>
  <aside class="sidebar">
    <div class="brand">
      <span class="material-icons">local_pharmacy</span>
      <span class="brand-text">Pharmacie MTIR</span>
    </div>
    <nav>...</nav>
    <div class="logout"><a href="login.html"><span class="material-icons">logout</span><span>Déconnexion</span></a></div>
  </aside>

  <div class="content">
    <div class="page-header">
      <h1>Logs des modifications</h1>
      <div class="welcome-msg">Bonjour, <strong>Admin</strong> !</div>
    </div>

    <table class="logs-table">
      <thead>
        <tr>
          <th>Message</th>
          <th>Date &amp; Heure</th>
        </tr>
      </thead>
      <tbody id="logsBody">
        <!-- Les logs s'affichent ici -->
      </tbody>
    </table>
  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.9.0/firebase-app.js";
    import { getFirestore, collection, query, orderBy, onSnapshot } from "https://www.gstatic.com/firebasejs/11.9.0/firebase-firestore.js";

    const firebaseConfig = { apiKey:"…", authDomain:"…", projectId:"pharmacie-mtir-db", storageBucket:"…", messagingSenderId:"…", appId:"…" };
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    const logsRef = collection(db, 'logs');
    const logsQuery = query(logsRef, orderBy('timestamp', 'desc'));
    const tbody = document.getElementById('logsBody');

    onSnapshot(logsQuery, snapshot => {
      tbody.innerHTML = '';
      snapshot.forEach(doc => {
        const data = doc.data();
        const msg = data.message || '';
        const time = data.timestamp?.toDate().toLocaleString() || '';
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td><div class="log-msg">${msg}</div></td>
          <td><div class="log-time">${time}</div></td>
        `;
        tbody.appendChild(tr);
      });
    }, err => console.error('Erreur écoute logs :', err));
  </script>
</body>
</html>